# π“ 10,000κ° λ§¤μ¥ ν™•μ¥μ„± λ¶„μ„

## κ²°λ΅ : β… κ°€λ¥ν•μ§€λ§ κ°μ„  ν•„μ”

`source_pipeline.ipynb`λ” **10,000κ° λ§¤μ¥ μ²λ¦¬κ°€ κΈ°μ μ μΌλ΅ κ°€λ¥**ν•μ§€λ§, **41.7μ‹κ°„**μ΄λΌλ” κΈ΄ μ²λ¦¬ μ‹κ°„κ³Ό **μ£Όν”Όν„° λ…ΈνΈλ¶μ μ—°κ²° μ•μ •μ„±** λ¬Έμ κ°€ μμµλ‹λ‹¤.

---

## 1. λ¦¬μ†μ¤ μ”κµ¬μ‚¬ν•­

### π’Ύ λ””μ¤ν¬ μ‚¬μ©λ‰
```
- ν…μ¤νΈ λ°μ΄ν„°: 24MB
- μ„λ² λ”© λ°μ΄ν„°: 586MB
- λ©”νƒ€λ°μ΄ν„°: ~50MB
β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”
μ΄ λ””μ¤ν¬: ~660MB (0.64GB)
```

**e2-standard-4 Persistent Disk (100GB)**: β… μ¶©λ¶„

---

### π§  λ©”λ¨λ¦¬ μ‚¬μ©λ‰
```
- collected_data (Phase 1): 72MB
- Chroma μΈλ±μ‹± (Phase 3): ~500MB
- Python ν”„λ΅μ„Έμ¤: ~200MB
β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”
μ΄ λ©”λ¨λ¦¬ ν”Όν¬: ~800MB
```

**e2-standard-4 (16GB RAM)**: β… μ¶©λ¶„ (λ©”λ¨λ¦¬μ 5%λ§ μ‚¬μ©)

---

### β±οΈ μ²λ¦¬ μ‹κ°„
```
Phase 1 (LLM μ§€μ‹ μμ§‘):
  - 10-15μ΄/λ§¤μ¥ (5κ° μ†μ¤)
  - API Rate Limit λ€κΈ° ν¬ν•¨

Phase 2 (κ²€μ¦):
  - μ¦‰μ‹ (λ©”λ¨λ¦¬ λ‚΄)

Phase 3 (λ²΅ν„° μΈλ±μ‹±):
  - 2μ΄/λ§¤μ¥ (μ„λ² λ”© μƒμ„±)
β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”
μ΄ μ²λ¦¬ μ‹κ°„: ~41.7μ‹κ°„ (1.7μΌ)
```

**λ¬Έμ μ **: β οΈ μ£Όν”Όν„° λ…ΈνΈλ¶μ΄ 41μ‹κ°„ λ™μ• μ—°κ²°μ„ μ μ§€ν•κΈ° μ–΄λ ¤μ›€

---

### π’° λΉ„μ©
```
- LLM νΈμ¶: 50,000ν (10,000 λ§¤μ¥ * 5 μ†μ¤)
- μ„λ² λ”© νΈμ¶: 200,000ν (10,000 λ§¤μ¥ * 20 μ²­ν¬)
β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”
μ΄ λΉ„μ©: ~$200
```

---

## 2. ν„μ¬ μ•„ν‚¤ν…μ²μ λ³‘λ©

### β λ³‘λ© 1: μμ°¨ μ²λ¦¬
```python
for idx, shop in enumerate(BATCH_SHOPS):
    result = auto_collect_shop_sources(...)  # 15μ΄ λ€κΈ°
    time.sleep(2)  # μ¶”κ°€ λ€κΈ°
```
- λ§¤μ¥μ„ ν•λ‚μ”© μμ°¨μ μΌλ΅ μ²λ¦¬
- 4 vCPUλ¥Ό ν¨μ¨μ μΌλ΅ ν™μ©ν•μ§€ λ»ν•¨

### β λ³‘λ© 2: λ©”λ¨λ¦¬μ— λ¨λ“  λ°μ΄ν„° λ³΄κ΄€
```python
collected_data = []  # 10,000κ° λ§¤μ¥ λ¨λ‘ λ©”λ¨λ¦¬μ—
for shop in BATCH_SHOPS:
    collected_data.append(result)
```
- μ‹¤ν¨ μ‹ μ²μλ¶€ν„° λ‹¤μ‹ μ‹μ‘ν•΄μ•Ό ν•¨
- μ¤‘κ°„ μ¬κ° λ¶κ°€λ¥

### β λ³‘λ© 3: μ£Όν”Όν„° λ…ΈνΈλ¶μ ν•κ³„
- 41μ‹κ°„ λ™μ• λΈλΌμ°μ €/μ»¤λ„ μ—°κ²° μ μ§€ ν•„μ”
- λ„¤νΈμ›ν¬ λκΉ€, λΈλΌμ°μ € λ‹«ν μ‹ μ „μ²΄ μ‹¤ν¨
- μ§„ν–‰ μƒν™© μ €μ¥ μ—†μ

---

## 3. κ°μ„  λ°©μ•

### β… λ°©μ• 1: λ°°μΉ λ¶„ν•  (κ°€μ¥ κ°„λ‹¨)
**ν„μ¬ λ…ΈνΈλ¶μ„ 1,000κ°μ”© 10λ² μ‹¤ν–‰**

```python
# Section 5 μμ •
BATCH_SHOPS = [
    # 1νμ°¨: shop_seq 1-1000
    {"shop_seq": 1, "shop_name": "...", "category": "..."},
    # ...
    {"shop_seq": 1000, "shop_name": "...", "category": "..."},
]

# 10λ² λ°λ³µ μ‹¤ν–‰ (μλ™)
```

**μ¥μ **:
- β… μ½”λ“ μμ • μµμ†ν™”
- β… μ‹¤ν¨ μ‹ ν•΄λ‹Ή λ°°μΉλ§ μ¬μ‹¤ν–‰
- β… μ£Όν”Όν„° μ„Έμ… 4μ‹κ°„μΌλ΅ λ‹¨μ¶•

**λ‹¨μ **:
- β μλ™μΌλ΅ 10λ² μ‹¤ν–‰ν•΄μ•Ό ν•¨
- β λ°°μΉ κ°„ μλ™ κ°μ… ν•„μ”

**μ²λ¦¬ μ‹κ°„**: 4μ‹κ°„ * 10ν = μ΄ 40μ‹κ°„ (μ‚¬λ μ‹κ°„ ν¬ν•¨)

---

### β… λ°©μ• 2: μ¤‘κ°„ μ €μ¥ + μ¬κ° κΈ°λ¥ μ¶”κ°€
**κ° λ§¤μ¥ μ²λ¦¬ ν›„ JSON νμΌλ΅ μ €μ¥**

```python
# Section 13 μμ • μμ‹
for idx, shop in enumerate(BATCH_SHOPS):
    result = auto_collect_shop_sources(...)

    # μ¦‰μ‹ νμΌλ΅ μ €μ¥
    with open(f"./checkpoints/shop_{shop['shop_seq']}.json", "w") as f:
        json.dump(result, f)

    collected_data.append(result)
```

**μ¬κ° λ΅μ§**:
```python
# κΈ°μ΅΄ μ²λ¦¬λ λ§¤μ¥ κ±΄λ„λ›°κΈ°
processed_seqs = [int(f.split('_')[1].split('.')[0])
                  for f in os.listdir('./checkpoints') if f.endswith('.json')]

BATCH_SHOPS = [s for s in BATCH_SHOPS if s['shop_seq'] not in processed_seqs]
```

**μ¥μ **:
- β… μ‹¤ν¨ μ‹ μ¤‘λ‹¨λ μ§€μ λ¶€ν„° μ¬κ°
- β… μ§„ν–‰ μƒν™© μ‹¤μ‹κ°„ μ €μ¥
- β… 10,000κ°λ¥Ό ν• λ²μ— μ‹¤ν–‰ κ°€λ¥

**λ‹¨μ **:
- β λ…ΈνΈλ¶ μ½”λ“ μμ • ν•„μ” (30λ¶„ μ‘μ—…)

**μ²λ¦¬ μ‹κ°„**: 41μ‹κ°„ (μ¤‘λ‹¨ μ—†μ΄ μ‹¤ν–‰ κ°€λ¥)

---

### β… λ°©μ• 3: Python μ¤ν¬λ¦½νΈλ΅ λ³€ν™ (κ¶μ¥)
**λ…ΈνΈλ¶μ„ `.py` μ¤ν¬λ¦½νΈλ΅ λ³€ν™ν•μ—¬ λ°±κ·ΈλΌμ΄λ“ μ‹¤ν–‰**

```bash
# Vertex AI Workbenchμ—μ„
nohup python source_pipeline.py > pipeline.log 2>&1 &

# λλ” tmux/screen μ„Έμ… μ‚¬μ©
tmux new -s pipeline
python source_pipeline.py
# Ctrl+B, Dλ΅ λ¶„λ¦¬
```

**μ¥μ **:
- β… λΈλΌμ°μ € μ—°κ²° λ¶ν•„μ”
- β… μ„Έμ… λκΉ€ κ±±μ • μ—†μ
- β… λ΅κ·Έ νμΌλ΅ μ§„ν–‰ μƒν™© ν™•μΈ
- β… λ³‘λ ¬ μ²λ¦¬ μ¶”κ°€ κ°€λ¥ (ν–¥ν›„)

**λ‹¨μ **:
- β λ…ΈνΈλ¶ β†’ μ¤ν¬λ¦½νΈ λ³€ν™ ν•„μ” (1μ‹κ°„ μ‘μ—…)

**μ²λ¦¬ μ‹κ°„**: 41μ‹κ°„ (λ¬΄μΈ μ‹¤ν–‰)

---

### β… λ°©μ• 4: λ³‘λ ¬ μ²λ¦¬ (μµμ ν™”)
**λ©€ν‹°ν”„λ΅μ„Έμ‹±μΌλ΅ λ™μ‹ μ²λ¦¬**

```python
from multiprocessing import Pool

def process_shop(shop):
    return auto_collect_shop_sources(
        shop["shop_seq"],
        shop["shop_name"],
        shop["category"]
    )

# 4κ° ν”„λ΅μ„Έμ¤λ΅ λ³‘λ ¬ μ²λ¦¬
with Pool(4) as pool:
    collected_data = pool.map(process_shop, BATCH_SHOPS)
```

**μ¥μ **:
- β… μ²λ¦¬ μ‹κ°„ 1/4λ΅ λ‹¨μ¶• (~10μ‹κ°„)
- β… 4 vCPU ν¨μ¨μ  ν™μ©

**λ‹¨μ **:
- β API Rate Limit κ³ λ ¤ ν•„μ”
- β Gemini API QPM μ ν•μ— κ±Έλ¦΄ κ°€λ¥μ„±
- β μ½”λ“ μμ • ν•„μ” (1μ‹κ°„ μ‘μ—…)

**μ²λ¦¬ μ‹κ°„**: 10-12μ‹κ°„ (Rate Limit κ³ λ ¤)

---

## 4. κ¶μ¥ μ „λµ

### π― λ‹¨κΈ° (μ§€κΈ λ‹Ήμ¥): λ°©μ• 1 (λ°°μΉ λ¶„ν• )
```python
# 1,000κ°μ”© 10λ² μ‹¤ν–‰
# κ° μ‹¤ν–‰: 4μ‹κ°„
# μλ™ κ°μ… ν•„μ”ν•μ§€λ§ μ½”λ“ μμ • μ—†μ
```

### π― μ¤‘κΈ° (1μ£ΌμΌ λ‚΄): λ°©μ• 2 + λ°©μ• 3
```python
# μ¤‘κ°„ μ €μ¥ κΈ°λ¥ μ¶”κ°€ (30λ¶„ μ‘μ—…)
# Python μ¤ν¬λ¦½νΈλ΅ λ³€ν™ (1μ‹κ°„ μ‘μ—…)
# β†’ 10,000κ°λ¥Ό 41μ‹κ°„ λ¬΄μΈ μ‹¤ν–‰
```

### π― μ¥κΈ° (1κ°μ›” λ‚΄): λ°©μ• 4
```python
# λ³‘λ ¬ μ²λ¦¬ μ¶”κ°€ (1μ‹κ°„ μ‘μ—…)
# API Rate Limit λ¨λ‹ν„°λ§ (2μΌ ν…μ¤νΈ)
# β†’ 10,000κ°λ¥Ό 10μ‹κ°„μ— μ²λ¦¬
```

---

## 5. κµ¬μ²΄μ  μ‹¤ν–‰ κ³„ν

### μµμ… A: μµμ† μμ • (μ¤λ μ‹μ‘ κ°€λ¥)
```
1. BATCH_SHOPSλ¥Ό 1,000κ°μ”© λ¶„ν• 
2. source_pipeline.ipynbλ¥Ό 10λ² μλ™ μ‹¤ν–‰
3. κ° μ‹¤ν–‰ μ „ shop_seq λ²”μ„ μμ •

μ΄ μ‹κ°„: 40μ‹κ°„ (μ‚¬λ κ°μ… μ‹κ°„ ν¬ν•¨)
μ΄ λΉ„μ©: $200
μ„ν—λ„: λ‚®μ
```

### μµμ… B: μ¤‘κ°„ μμ • (1μΌ μ¤€λΉ„)
```
1. Section 13μ— μ²΄ν¬ν¬μΈνΈ μ €μ¥ μ¶”κ°€
2. μ¬κ° λ΅μ§ μ¶”κ°€
3. λ…ΈνΈλ¶μ„ .py μ¤ν¬λ¦½νΈλ΅ λ³€ν™
4. nohupμΌλ΅ λ°±κ·ΈλΌμ΄λ“ μ‹¤ν–‰

μ΄ μ‹κ°„: 41μ‹κ°„ (λ¬΄μΈ μ‹¤ν–‰)
μ΄ λΉ„μ©: $200
μ„ν—λ„: λ‚®μ
```

### μµμ… C: μµμ ν™” (3μΌ μ¤€λΉ„ + ν…μ¤νΈ)
```
1. λ©€ν‹°ν”„λ΅μ„Έμ‹± μ¶”κ°€
2. Rate Limit ν•Έλ“¤λ§ κµ¬ν„
3. API νΈμ¶ λ¨λ‹ν„°λ§
4. 2,000κ°λ΅ νμΌλΏ ν…μ¤νΈ

μ΄ μ‹κ°„: 10-12μ‹κ°„ (λ¬΄μΈ μ‹¤ν–‰)
μ΄ λΉ„μ©: $200
μ„ν—λ„: μ¤‘κ°„ (API μ ν• κ°€λ¥μ„±)
```

---

## 6. μ§λ¬Έμ— λ€ν• μµμΆ… λ‹µλ³€

### β… Q1: 10,000κ° λ§¤μ¥ λ²΅ν„° DB κµ¬μ¶• κ°€λ¥ν•κ°€?
**λ‹µλ³€**: **μ, κ°€λ¥ν•©λ‹λ‹¤.**

- λ””μ¤ν¬: 660MB ν•„μ” (100GB μ¤‘)
- λ©”λ¨λ¦¬: 800MB ν•„μ” (16GB μ¤‘ 5%)
- μ‹κ°„: 41μ‹κ°„ (λ°°μΉ λ¶„ν•  μ‹ 4μ‹κ°„ * 10ν)
- λΉ„μ©: $200

### β… Q2: e2-standard-4 μΈμ¤ν„΄μ¤λ΅ κ°€λ¥ν•κ°€?
**λ‹µλ³€**: **μ, μ¶©λ¶„ν•©λ‹λ‹¤.**

- 4 vCPU: μμ°¨ μ²λ¦¬ κΈ°μ¤€ 1κ°λ§ μ‚¬μ© (λ³‘λ ¬ μ‹ 4κ° ν™μ©)
- 16GB RAM: 800MBλ§ μ‚¬μ© (λ©”λ¨λ¦¬ μ—¬μ  95%)
- 100GB Disk: 660MBλ§ μ‚¬μ© (λ””μ¤ν¬ μ—¬μ  99%)

### β οΈ λ‹¨, λ‹¤μ κ°μ„  κ¶μ¥:
1. **λ°°μΉ λ¶„ν• **: 1,000κ°μ”© 10λ² μ‹¤ν–‰ (κ°€μ¥ κ°„λ‹¨)
2. **μ²΄ν¬ν¬μΈνΈ μ €μ¥**: μ¤‘λ‹¨ μ‹ μ¬κ° κ°€λ¥
3. **μ¤ν¬λ¦½νΈ λ³€ν™**: μ£Όν”Όν„° μ—°κ²° λ¶ν•„μ”
4. **(μ„ νƒ) λ³‘λ ¬ μ²λ¦¬**: μ²λ¦¬ μ‹κ°„ 1/4 λ‹¨μ¶•

---

## 7. λ‹¤μ λ‹¨κ³„

μ–΄λ–¤ μµμ…μ„ μ„ νƒν•μ‹κ² μµλ‹κΉ?

1. **μµμ… A**: μ§€κΈ λ‹Ήμ¥ 1,000κ°μ”© μλ™ μ‹¤ν–‰ (μ½”λ“ μμ • μ—†μ)
2. **μµμ… B**: μ²΄ν¬ν¬μΈνΈ + μ¤ν¬λ¦½νΈ λ³€ν™ (1μΌ μ¤€λΉ„, 41μ‹κ°„ λ¬΄μΈ μ‹¤ν–‰)
3. **μµμ… C**: λ³‘λ ¬ μ²λ¦¬ μµμ ν™” (3μΌ μ¤€λΉ„, 10μ‹κ°„ μ‹¤ν–‰)

---

μƒμ„±μΌ: 2025-11-11
λ¶„μ„ λ€μƒ: `source_pipeline.ipynb`
λ€μƒ κ·λ¨: 10,000κ° λ§¤μ¥
μΈμ¤ν„΄μ¤: e2-standard-4 (4 vCPU, 16GB RAM, 100GB Disk)
